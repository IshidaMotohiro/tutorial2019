
## --------------------------------------------------------------
## MeCa„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´„Å´„Å§„ÅÑ„Å¶„ÅØ„Çí
browseURL("https://sites.google.com/site/rmecab/")
##ÂèÇÁÖß

#library(RMeCab)
# utf8„Éï„Ç©„É´„ÉÄ„Å™„ÅÑ„Åósjis„Éï„Ç©„É´„ÉÄ„Å´„Éï„Ç°„Ç§„É´„Åå„ÅÇ„Çã„Å®„Åô„Çã
#df <- docDF("utf8", type = 1)

load("df.Rdata")

## ------------------------------------------------------------------------
head(df)


## --------------------------------------------------------------
## # „Å©„Çì„Å™ÂçòË™û„Åå„ÅÇ„Çã„ÅÆ„Åã

df$TERM  %>%  head(20)


## ------------------------------------------------------------------------
df[df$TERM=="ÈñãÁô∫" , ]


## ------------------------------------------------------------------------
df[rowSums(df[, c("ÊñáÊõ∏1", "ÊñáÊõ∏2", "ÊñáÊõ∏3")]) > 5, ]



## --------------------------------------------------------------
df$ÂêàË®à <- round(rowSums(df[, c("ÊñáÊõ∏1", "ÊñáÊõ∏2", "ÊñáÊõ∏3")]), 2)„Åà


## --------------------------------------------------------------
df %>% head()


## ------------------------------------------------------------------------
df$Ê®ôÊ∫ñÂåñ <- scale(df$ÂêàË®à)


## --------------------------------------------------------------
df %>% head()


## --------------------------------------------------------------
## install.packages("tidyverse")
library(tidyverse)



## --------------------------------------------------------------
df %>% head


## --------------------------------------------------------------
df %>% gather(key = Word,value = FREQ, ÊñáÊõ∏1, ÊñáÊõ∏2, ÊñáÊõ∏3) 


## ------------------------------------------------------------------------
tb <- tibble(
  Name = LETTERS[1:5],
  X = 1:5, 
  Y = X^2
)


## --------------------------------------------------------------
tb


## ------------------------------------------------------------------------
temp <- tb[tb$Name=="B",]
max(temp$Y)


## ------------------------------------------------------------------------
max(tb[tb$Name=="B", ]$Y)


## ------------------------------------------------------------------------
# max(df2[df2$Name=="B",]$m)
tb %>% 
  filter(Name == "B") %>% 
  select(Y) %>% max()


## ------------------------------------------------------------------------
tb %>% 
  select(Name, Y) %>% 
  arrange(desc(Name)) %>% 
  head()


## ------------------------------------------------------------------------
tb %>% filter(Y >= 5)


## ------------------------------------------------------------------------
tb2 <- tb
tb2$Y <- scale(tb2$Y)
head(tb2)


## ------------------------------------------------------------------------
tb %>% 
  mutate(Y2 = scale(Y)) %>% 
  head()


## --------------------------------------------------------------
dat <- data.frame(Y = 1:6, X1 = c("A", "A", "B", "B", "C", "C"), X2 = 2:7, X3 = 3:8)


## ------------------------------------------------------------------------
dat


## ------------------------------------------------------------------------
dat %>% mutate_if( is.numeric, log )


## ------------------------------------------------------------------------
dat %>% summarise( X2_mean = mean(X2), 
                   X2_sd = mean(X2))


## ------------------------------------------------------------------------
dat %>% summarise_if( is.numeric, mean )


## ------------------------------------------------------------------------
dat %>% summarise_if( is.numeric, list(mean, var))


## ------------------------------------------------------------------------
dat %>% summarise_if( is.numeric,  list(~mean(.), ~sd(.)))


## --------------------------------------------------------------
text <- "
Name|Time1|Time2|Time3
A|0.1|0.18|0.11
B|0.3|0.33|0.35
C|0.2|0.22|0.26
D|0.44|0.47|0.43
E|0.51|0.56|0.55
F|0.60|0.66|0.68
G|0.77|0.78|0.72
H|0.81|0.88|0.86
"
yoko <- read_delim(file = text, delim = "|")


## ------------------------------------------------------------------------
yoko %>% head()




## --------------------------------------------------------------
yoko2 <-yoko %>% gather(
  key = time, 
  value = score, -Name)
yoko2


## --------------------------------------------------------------
df %>% head()


## ------------------------------------------------------------------------
df %>% gather(key = Doc, value = FREQ, 
              ÊñáÊõ∏1, ÊñáÊõ∏2, ÊñáÊõ∏3) %>% head()


## seiseki_Demo.R„ÇíÂèÇÁÖß
## ------------------------------------------------------------------------
Â≠¶ÁîüÁï™Âè∑ <- stri_trans_nfkc_casefold(
 "ÔºëÔºêÔºëÔºòÔºêÔºïÔºëÔºîÔºïÔºòÁü≥Áî∞Âü∫Â∫É.xlsx") %>%
     str_extract(
     "\\d{8,10}\\p{Han}*.xlsx$")


## --------------------------------------------------------------
Â≠¶ÁîüÁï™Âè∑



## ------„Ç∞„É©„Éï„Ç£„ÉÉ„ÇØ„Çπ„ÅÆÊó•Êú¨Ë™ûË®≠ÂÆö------------------------------------------------------------------
source("http://rmecab.jp/R/Rprofile.R")


## --------------------------------------------------------------
doc <- df %>% gather(key = Doc, 
  value = FREQ, 
  ÊñáÊõ∏1, ÊñáÊõ∏2, ÊñáÊõ∏3) 


## ------------------------------------------------------------------------
p <- doc %>% 
  ggplot(aes(POS1,
             FREQ,
             fill=Doc)) +
  geom_bar(stat = 
             "identity")


## --------------------------------------------------------------
p


## --------------------------------------------------------------
## install.packages("gapminder")
library(gapminder)


## --------------------------------------------------------------
yr <- gapminder %>%  select(-c(pop, gdpPercap)) %>% spread(key = year , value =  lifeExp)
yr



## ------------------------------------------------------------------------
gapminder <- gapminder %>%  
  filter(country %in% 
           c("Japan", "China", "Korea, Rep.")) 


## ------------------------------------------------------------------------
library(ggplot2)
p <- gapminder %>% 
  ggplot() 
# ggplot(gapminder)


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- p +
  aes(x = year, 
      y = lifeExp,
      size = pop,
      col = country)


## --------------------------------------------------------------
p


## --------------------------------------------------------------
## gapminder %>%
##   ggplot(aes(x = year, y = lifeExp,
##          size = pop,col = country))


## ------------------------------------------------------------------------
p <- p + geom_point() 


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p0 <- gapminder  %>% 
  ggplot(aes(
   x = year, 
   y = lifeExp, 
   size = pop))  +
  geom_point(
    show.legend = 
    FALSE,
    col = "red") #üëà


## --------------------------------------------------------------
p0


## ------------------------------------------------------------------------
gapminder %>% 
  group_by(year) %>% 
  summarise(AVG = mean(gdpPercap)) 


## ------------------------------------------------------------------------
p <- gapminder %>% 
  ggplot(aes(year, 
    gdpPercap)) +
  geom_bar(stat = 
    "summary",
    fun.y = "mean")


## --------------------------------------------------------------
p


## --------------------------------------------------------------
gap_avg <- gapminder %>% 
  group_by(year) %>% 
  summarise(AVG = mean(gdpPercap)) 


## ------------------------------------------------------------------------
gap_avg


## ------------------------------------------------------------------------
p <- gap_avg %>% 
  ggplot(
   aes(year, AVG)) +
  geom_bar(
  stat ="identity")


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- gapminder %>% 
  ggplot(aes(year, 
    gdpPercap)) +
  stat_summary(
    geom = "bar",
    fun.y = "mean") +
  stat_summary(
    geom = "errorbar",
    fun.data = "mean_se")



## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- doc %>% 
  ggplot(aes(POS1,
             FREQ,
        fill = Doc)) +
  geom_bar(stat =
      "identity")


## ------------------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- gapminder %>% 
  filter(country == "China") %>% 
  ggplot(aes(lifeExp)) +
  geom_histogram()


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- gapminder %>% 
  filter(country == "China") %>% 
  ggplot(aes(lifeExp)) +
  geom_histogram(bins = 6)


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- gapminder %>% 
  filter(country == "China") %>% 
  ggplot(aes(lifeExp,
    y = ..density.. )) +
  geom_histogram(bins = 6)


## ------------------------------------------------------------------------
p + geom_density()


## ------------------------------------------------------------------------
p <- gapminder %>% 
  ggplot(aes(year, 
    lifeExp,
    group=country)) +
  geom_line()


## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p <- gapminder %>% 
  ggplot(
   aes(x=country, 
       y=gdpPercap)) +
  geom_boxplot()



## --------------------------------------------------------------
p


## ------------------------------------------------------------------------
p_f <- p + 
  facet_grid(. 
    ~ country)


## ------------------------------------------------------------------------
p_f


## ------------------------------------------------------------------------
p_f <- p + 
  facet_grid(. 
    ~ country,
    scales = "free")


## ------------------------------------------------------------------------
p_f


## ------------------------------------------------------------------------
p <- p +
  theme_classic()


## --------------------------------------------------------------
p 

